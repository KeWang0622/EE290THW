
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{HW4}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}337}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
          \PY{k+kn}{from} \PY{n+nn}{ipywidgets} \PY{k}{import} \PY{n}{interact}\PY{p}{,} \PY{n}{widgets}
          \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k}{import} \PY{n}{display}
          \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{linalg}
          \PY{k+kn}{from} \PY{n+nn}{IPython} \PY{k}{import} \PY{n}{display}
          \PY{k+kn}{import} \PY{n+nn}{pywt}
          \PY{k+kn}{from} \PY{n+nn}{skimage} \PY{k}{import} \PY{n}{data}
          \PY{k+kn}{import} \PY{n+nn}{skimage}
          \PY{k+kn}{from} \PY{n+nn}{skimage} \PY{k}{import} \PY{n}{data}
          \PY{k+kn}{from} \PY{n+nn}{skimage} \PY{k}{import} \PY{n}{io}
\end{Verbatim}


    \section{EE290T Homework 4 - Programming
Assignment}\label{ee290t-homework-4---programming-assignment}

\subsection{Part 1 - Proximal gradient methods for
LASSO}\label{part-1---proximal-gradient-methods-for-lasso}

In this assignment, we'll go through the algorithms presented in Ch 8
for Lasso. The Lasso formulation is given by:

\[\min_{\boldsymbol x} \frac{1}{2} \|\boldsymbol y- \boldsymbol A \boldsymbol x\|_2^2 + \lambda \|\boldsymbol x\|_1 \]

Given \(\boldsymbol y \in R^m\), \(\boldsymbol A\in R^{mxn}\) and
\(\boldsymbol x \in R^n\)

\textbf{(a)} Implement Proximal Gradient for Lasso (sometimes called
iterative shrinkage thresholding algorithm (ISTA)). This algorithm is
given by:

\textbf{Input:} \(\boldsymbol x_0 \in R^n\) and
\(L \geq \lambda_{max}(\boldsymbol A^* \boldsymbol A)\) \textbf{while}
\(\boldsymbol x_k\) not converged (k=1,2, ...) \textbf{do}
\textgreater{}
\(\boldsymbol w_k \leftarrow \frac{1}{L}\boldsymbol A^* (\boldsymbol A \boldsymbol x_k -\boldsymbol y)\)
\$\boldsymbol x\_\{k+1\} \leftarrow \$
soft\((\boldsymbol w_k, \lambda/L)\)

\textbf{end while} \textbf{Output:
\(\boldsymbol x_* \leftarrow \boldsymbol x_k\)}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{k}{def} \PY{n+nf}{soft\PYZus{}thresh}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{l}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{sign}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{maximum}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{l}\PY{p}{,} \PY{l+m+mf}{0.}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{k}{def} \PY{n+nf}{ista}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{L}\PY{p}{,}\PY{n}{A}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{lamda}\PY{p}{,}\PY{n}{x}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Your code here\PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{n}{x0} \PY{o}{=} \PY{n}{x1}
             \PY{n}{converge} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{)}\PY{p}{:}
                 \PY{n}{w} \PY{o}{=} \PY{n}{x0} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n}{L}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A}\PY{p}{,}\PY{n}{x0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{y}\PY{p}{)}
                 \PY{n}{x01} \PY{o}{=} \PY{n}{soft\PYZus{}thresh}\PY{p}{(}\PY{n}{w}\PY{p}{,}\PY{n}{lamda}\PY{o}{/}\PY{n}{L}\PY{p}{)}
                 \PY{n}{converge}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{x01}\PY{o}{\PYZhy{}}\PY{n}{x}\PY{p}{)}\PY{p}{)}
                 \PY{n}{x0} \PY{o}{=} \PY{n}{x01}
             \PY{k}{return} \PY{n}{x0}\PY{p}{,}\PY{n}{converge}
\end{Verbatim}


    \textbf{(b)} Now, add the acceleration term and imeplement accelerated
proximal gradient method for LASSO (also called FISTA, or fast ISTA).

\textbf{Input:} \(\boldsymbol x_0 \in R^n\),
\(\boldsymbol p_1 \leftarrow \boldsymbol x_0\), \$t\_1 \leftarrow 1
\$and \(L \geq \lambda_{max}(\boldsymbol A^* \boldsymbol A)\)
\textbf{while} \(\boldsymbol x_k\) not converged (k=1,2, ...)
\textbf{do} \textgreater{}
\(\boldsymbol w_k \leftarrow \boldsymbol p_k -\frac{1}{L} \boldsymbol A^*(\boldsymbol A \boldsymbol p_k -y)\)
\$\boldsymbol x\_\{k+1\} \leftarrow \$
soft\((\boldsymbol w_k, \lambda/L)\)
\(t_{k+1} \leftarrow \frac{1+\sqrt{1+4t_k^2}}{2}; \beta_{k+1} \leftarrow \frac{t_{k}-1}{t_{k+1}}\)
\(\boldsymbol p_{k+1} \leftarrow \boldsymbol x_{k+1} + \beta_{k+1} (\boldsymbol x_{k+1} - \boldsymbol x_k)\)

\textbf{end while} \textbf{Output:
\(\boldsymbol x_* \leftarrow \boldsymbol x_k\)}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}104}]:} \PY{k}{def} \PY{n+nf}{fista}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{L}\PY{p}{,}\PY{n}{A}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{lamda}\PY{p}{,}\PY{n}{x}\PY{p}{)}\PY{p}{:}
              \PY{n}{xk} \PY{o}{=} \PY{n}{x1}
              \PY{n}{pk} \PY{o}{=} \PY{n}{xk}
              \PY{n}{tk} \PY{o}{=} \PY{l+m+mi}{1}
              \PY{n}{converge} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{)}\PY{p}{:}
                  \PY{n}{wk} \PY{o}{=} \PY{n}{pk} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n}{L}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A}\PY{p}{,}\PY{n}{pk}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{y}\PY{p}{)}
                  \PY{n}{xk1} \PY{o}{=} \PY{n}{soft\PYZus{}thresh}\PY{p}{(}\PY{n}{wk}\PY{p}{,}\PY{n}{lamda}\PY{o}{/}\PY{n}{L}\PY{p}{)}
                  \PY{n}{tk1} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{+}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{+}\PY{l+m+mi}{4}\PY{o}{*}\PY{n}{tk}\PY{o}{*}\PY{n}{tk}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}
                  \PY{n}{bbk} \PY{o}{=} \PY{p}{(}\PY{n}{tk}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{/}\PY{n}{tk1}
                  \PY{n}{pk1} \PY{o}{=} \PY{n}{xk1} \PY{o}{+} \PY{n}{bbk}\PY{o}{*}\PY{p}{(}\PY{n}{xk1}\PY{o}{\PYZhy{}}\PY{n}{xk}\PY{p}{)}
                  \PY{n}{pk} \PY{o}{=} \PY{n}{pk1}
                  \PY{n}{xk} \PY{o}{=} \PY{n}{xk1}
                  \PY{n}{tk} \PY{o}{=} \PY{n}{tk1}
                  \PY{n}{converge}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{xk}\PY{o}{\PYZhy{}}\PY{n}{x}\PY{p}{)}\PY{p}{)}
              
              \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Your code here\PYZdq{}\PYZdq{}\PYZdq{}}
              \PY{k}{return} \PY{n}{xk}\PY{p}{,}\PY{n}{converge}
\end{Verbatim}


    \textbf{(c)} Implement the Augmented Lagrange Multiplier (ALM) method
for basis pursuit based on Algorithm 8.5 in the textbook. The ALM method
is given by:

\textbf{Input:} \(\boldsymbol x_0 \in R^n\) and \(\beta > 1\)
\textbf{while} \$ \{\boldsymbol x\_k, \boldsymbol \lambda\emph{k \}\$
not converged (k=1,2, ...) \textbf{do} \textgreater{}
\(\boldsymbol x_{k+1} \leftarrow \arg \min \mathcal{L}_{\mu_k} (\boldsymbol x, \boldsymbol \lambda_k) \text{ using APG}\)
\(\boldsymbol \lambda_{k+1} \leftarrow \boldsymbol \lambda_k + \mu_k (\boldsymbol A \boldsymbol x_{k+1} - \boldsymbol y)\)
\$ \mu}\{k+1\} \leftarrow \text{min}\{\beta \mu\emph{k, \mu}\{max\}\}\$

\textbf{end while} \textbf{Output:
\(\boldsymbol x_* \leftarrow \boldsymbol x_k\)}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}141}]:} \PY{k}{def} \PY{n+nf}{fista\PYZus{}alm}\PY{p}{(}\PY{n}{x1}\PY{p}{,}\PY{n}{L}\PY{p}{,}\PY{n}{A}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{lamda}\PY{p}{,}\PY{n}{uk}\PY{p}{,}\PY{n}{lk}\PY{p}{)}\PY{p}{:}
              \PY{n}{xk} \PY{o}{=} \PY{n}{x1}
              \PY{n}{pk} \PY{o}{=} \PY{n}{xk}
              \PY{n}{tk} \PY{o}{=} \PY{l+m+mi}{1}
              \PY{n}{converge} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{)}\PY{p}{:}
                  \PY{n}{wk} \PY{o}{=} \PY{n}{pk} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{n}{uk}\PY{o}{/}\PY{n}{L}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A}\PY{p}{,}\PY{n}{pk}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{y}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n}{L}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{lk}\PY{p}{)}
                  \PY{n}{xk1} \PY{o}{=} \PY{n}{soft\PYZus{}thresh}\PY{p}{(}\PY{n}{wk}\PY{p}{,}\PY{n}{lamda}\PY{o}{/}\PY{n}{L}\PY{p}{)}
                  \PY{n}{tk1} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{+}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{+}\PY{l+m+mi}{4}\PY{o}{*}\PY{n}{tk}\PY{o}{*}\PY{n}{tk}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{2}
                  \PY{n}{bbk} \PY{o}{=} \PY{p}{(}\PY{n}{tk}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{/}\PY{n}{tk1}
                  \PY{n}{pk1} \PY{o}{=} \PY{n}{xk1} \PY{o}{+} \PY{n}{bbk}\PY{o}{*}\PY{p}{(}\PY{n}{xk1}\PY{o}{\PYZhy{}}\PY{n}{xk}\PY{p}{)}
                  \PY{n}{pk} \PY{o}{=} \PY{n}{pk1}
                  \PY{n}{xk} \PY{o}{=} \PY{n}{xk1}
                  \PY{n}{tk} \PY{o}{=} \PY{n}{tk1}
          \PY{c+c1}{\PYZsh{}         converge.append(np.linalg.norm(xk\PYZhy{}x))}
              
              \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Your code here\PYZdq{}\PYZdq{}\PYZdq{}}
              \PY{k}{return} \PY{n}{xk}
          
          \PY{k}{def} \PY{n+nf}{alm}\PY{p}{(}\PY{n}{l0}\PY{p}{,}\PY{n}{x0}\PY{p}{,}\PY{n}{L}\PY{p}{,}\PY{n}{beta}\PY{p}{,}\PY{n}{A}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{lamda}\PY{p}{,}\PY{n}{umax}\PY{p}{,}\PY{n}{x}\PY{p}{)}\PY{p}{:}
              \PY{n}{xk} \PY{o}{=} \PY{n}{x0}
          \PY{c+c1}{\PYZsh{}     betak = beta}
              \PY{n}{uk} \PY{o}{=} \PY{l+m+mi}{1}
              \PY{n}{converge} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{n}{lk} \PY{o}{=} \PY{n}{l0}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{)}\PY{p}{:}
                  \PY{n+nb}{print}\PY{p}{(}\PY{n}{i}\PY{p}{)}
                  \PY{n}{xk1} \PY{o}{=} \PY{n}{fista\PYZus{}alm}\PY{p}{(}\PY{n}{x0}\PY{p}{,}\PY{n}{L}\PY{p}{,}\PY{n}{A}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{lamda}\PY{p}{,}\PY{n}{uk}\PY{p}{,}\PY{n}{lk}\PY{p}{)}
                  \PY{n}{lk1} \PY{o}{=} \PY{n}{lk} \PY{o}{+} \PY{n}{uk}\PY{o}{*}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A}\PY{p}{,}\PY{n}{xk1}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{y}\PY{p}{)} 
          \PY{c+c1}{\PYZsh{}         print(umax,beta*uk)}
                  \PY{n}{uk1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{p}{(}\PY{n}{beta}\PY{o}{*}\PY{n}{uk}\PY{p}{,}\PY{n}{umax}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}         print(lk1)}
          \PY{c+c1}{\PYZsh{}         print(uk1)}
                  \PY{n}{xk} \PY{o}{=} \PY{n}{xk1}
                  \PY{n}{uk} \PY{o}{=} \PY{n}{uk1}
                  \PY{n}{lk} \PY{o}{=} \PY{n}{lk1}
                  \PY{n}{converge}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{xk}\PY{o}{\PYZhy{}}\PY{n}{x}\PY{p}{)}\PY{p}{)}
              
              \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Your code here\PYZdq{}\PYZdq{}\PYZdq{}}
              \PY{k}{return} \PY{n}{xk}\PY{p}{,}\PY{n}{converge}
\end{Verbatim}


    \textbf{(d)} Using your code for projected subgradient method (previous
homework), plot the convergence rates of projected subgradient method,
ISTA, FISTA, and ALM.

To do this, simulate a signal corrupted by noise:
\(\boldsymbol y = \boldsymbol A \boldsymbol x + \boldsymbol n\)

Given \(\boldsymbol y \in R^m\), \(\boldsymbol A\in R^{mxn}\) and
\(\boldsymbol x \in R^n\)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{k}{def} \PY{n+nf}{sign}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n}{x} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{k}{return} \PY{l+m+mi}{1}
             \PY{k}{if} \PY{n}{x} \PY{o}{\PYZlt{}} \PY{l+m+mi}{0}\PY{p}{:}
                 \PY{k}{return} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{k}{else}\PY{p}{:}
                 \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{uniform}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{def} \PY{n+nf}{sign\PYZus{}v}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
             \PY{n}{x\PYZus{}p} \PY{o}{=} \PY{n}{x}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}     print(x.size)}
             \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{size}\PY{p}{)}\PY{p}{:}
                 \PY{n}{x\PYZus{}p}\PY{p}{[}\PY{n}{j}\PY{p}{]} \PY{o}{=} \PY{n}{sign}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{)}
             \PY{k}{return} \PY{n}{x\PYZus{}p}
         \PY{k}{def} \PY{n+nf}{projected\PYZus{}gradient\PYZus{}descent}\PY{p}{(}\PY{n}{A}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{n}{iteration}\PY{p}{,}\PY{n}{x}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Your code here\PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{n}{At} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{inv}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A}\PY{p}{,}\PY{n}{A}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n}{Atau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{At}\PY{p}{,}\PY{n}{A}\PY{p}{)}
             \PY{n}{Tau} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{identity}\PY{p}{(}\PY{n}{A}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{Atau}
             \PY{n}{x\PYZus{}hat} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{At}\PY{p}{,}\PY{n}{y}\PY{p}{)}
             \PY{n}{x0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{x\PYZus{}hat}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
             \PY{n}{t} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{converge} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{iteration}\PY{p}{)}\PY{p}{:}
         \PY{c+c1}{\PYZsh{}         print(i)}
                 \PY{n}{t} \PY{o}{=} \PY{n}{t}\PY{o}{+}\PY{l+m+mi}{1}
                 \PY{n}{x01} \PY{o}{=} \PY{n}{x\PYZus{}hat} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{Tau}\PY{p}{,}\PY{p}{(}\PY{n}{x0}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{/}\PY{n}{t}\PY{p}{)}\PY{o}{*}\PY{n}{sign\PYZus{}v}\PY{p}{(}\PY{n}{x0}\PY{p}{)}\PY{p}{)}\PY{p}{)}
                 \PY{n}{converge}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{x01}\PY{o}{\PYZhy{}}\PY{n}{x}\PY{p}{)}\PY{p}{)}
                 \PY{n}{x0} \PY{o}{=} \PY{n}{x01}
         \PY{c+c1}{\PYZsh{}         x\PYZus{}all.append(x0)}
             \PY{k}{return} \PY{n}{x0}\PY{p}{,}\PY{n}{converge}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n}{n} \PY{o}{=} \PY{l+m+mi}{32}             \PY{c+c1}{\PYZsh{} image height/width}
         \PY{n}{N} \PY{o}{=} \PY{n}{n}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}           \PY{c+c1}{\PYZsh{} flat image}
         \PY{c+c1}{\PYZsh{}     m = N              \PYZsh{} number of measurements }
         \PY{n}{m} \PY{o}{=} \PY{l+m+mi}{300}
         \PY{n}{k} \PY{o}{=} \PY{l+m+mi}{50}            \PY{c+c1}{\PYZsh{} number of non\PYZhy{}zero entries in the image}
         
         \PY{c+c1}{\PYZsh{} Create image x}
         \PY{n}{x} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{rand}\PY{p}{(}\PY{n}{k}\PY{p}{)}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{N}\PY{o}{\PYZhy{}}\PY{n}{k}\PY{p}{)}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} Create sparse vector }
         \PY{n}{x} \PY{o}{=} \PY{n}{x}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{permutation}\PY{p}{(}\PY{n}{N}\PY{p}{)}\PY{p}{]}\PY{p}{;}
         
         
         \PY{n}{A} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{p}{(}\PY{n}{m}\PY{p}{,}\PY{n}{N}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Create measurement matrix, A}
         \PY{n}{A}\PY{p}{[}\PY{n}{A}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
         
         \PY{n}{y} \PY{o}{=} \PY{n}{A}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{+}\PY{l+m+mf}{0.01}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{normal}\PY{p}{(}\PY{n}{size}\PY{o}{=}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{)}  \PY{c+c1}{\PYZsh{} y=Ax}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{n}{AtA} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{matmul}\PY{p}{(}\PY{n}{A}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{A}\PY{p}{)}
         \PY{n}{e} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{eig}\PY{p}{(}\PY{n}{AtA}\PY{p}{)}
         \PY{n}{L}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{L}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
2436.766293893759

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}114}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Your code here\PYZdq{}\PYZdq{}\PYZdq{}}
          
          \PY{n}{x\PYZus{}ista} \PY{o}{=} \PY{n}{ista}\PY{p}{(}\PY{n}{A}\PY{o}{=}\PY{n}{A}\PY{p}{,}\PY{n}{L}\PY{o}{=}\PY{n}{L}\PY{p}{,}\PY{n}{lamda}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{y}\PY{p}{,}\PY{n}{x}\PY{o}{=}\PY{n}{x}\PY{p}{)}
          \PY{n}{x\PYZus{}pgd} \PY{o}{=} \PY{n}{projected\PYZus{}gradient\PYZus{}descent}\PY{p}{(}\PY{n}{A} \PY{o}{=} \PY{n}{A}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{y}\PY{p}{,}\PY{n}{iteration}\PY{o}{=}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x}\PY{o}{=}\PY{n}{x}\PY{p}{)}
          \PY{n}{x\PYZus{}fista} \PY{o}{=} \PY{n}{fista}\PY{p}{(}\PY{n}{A}\PY{o}{=}\PY{n}{A}\PY{p}{,}\PY{n}{L}\PY{o}{=}\PY{n}{L}\PY{p}{,}\PY{n}{lamda}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{y}\PY{p}{,}\PY{n}{x}\PY{o}{=}\PY{n}{x}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}142}]:} \PY{n}{x\PYZus{}alm} \PY{o}{=}  \PY{n}{alm}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{,}\PY{n}{L}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{A}\PY{p}{,}\PY{n}{y}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{x}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}144}]:} \PY{n}{x\PYZus{}alm}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}144}]:} array([-0.        ,  0.        , -0.        , {\ldots},  0.39480229,
                  0.        ,  0.        ])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}147}]:} \PY{c+c1}{\PYZsh{}log}
          \PY{c+c1}{\PYZsh{} plt.ylim([0,5])}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{x\PYZus{}ista}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{x\PYZus{}pgd}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{x\PYZus{}fista}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linestyle} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{x\PYZus{}alm}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,}\PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linestyle} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} plt.ylim([0,5])}
          \PY{c+c1}{\PYZsh{} plt.plot(x\PYZus{}ista[1],color = \PYZsq{}r\PYZsq{}, linestyle=\PYZsq{}\PYZhy{}\PYZsq{})}
          \PY{c+c1}{\PYZsh{} plt.plot(x\PYZus{}pgd[1],color = \PYZsq{}b\PYZsq{}, linestyle=\PYZsq{}\PYZhy{}\PYZsq{})}
          \PY{c+c1}{\PYZsh{} plt.plot(x\PYZus{}fista[1],color = \PYZsq{}g\PYZsq{},linestyle = \PYZsq{}\PYZhy{}\PYZsq{})}
          \PY{c+c1}{\PYZsh{} plt.plot(x\PYZus{}alm[1],color = \PYZsq{}k\PYZsq{},linestyle = \PYZsq{}\PYZhy{}\PYZsq{})}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Convergence rates}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{iterations}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_16_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{k+kn}{import} \PY{n+nn}{sigpy}\PY{n+nn}{.}\PY{n+nn}{plot} \PY{k}{as} \PY{n+nn}{pl}
\end{Verbatim}


    \textbf{(d)} Does this match your expectation? What are the pros/cons of
these methods?

In general, the results match my expectation, Fista converge faster than
Ista, and ALM turns to be the best but the slowest.

    \textbf{(Bonus)} Use ISTA/FISTA/or ALM to solve a problem of your
choice!

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}220}]:} \PY{n}{img} \PY{o}{=} \PY{n}{io}\PY{o}{.}\PY{n}{imread}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pikachu.jpg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{as\PYZus{}grey}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)} 
          \PY{n}{img} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{img} \PY{o}{+}\PY{l+m+mi}{1}
          \PY{c+c1}{\PYZsh{} img = img[\PYZhy{}1:0:\PYZhy{}1,:]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}185}]:} \PY{k+kn}{import} \PY{n+nn}{cv2}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}221}]:} \PY{n}{imm} \PY{o}{=} \PY{n}{cv2}\PY{o}{.}\PY{n}{resize}\PY{p}{(}\PY{n}{img}\PY{p}{,}\PY{p}{(}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{80}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}200}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{imm}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
0.042492412767768675

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}223}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Your code here\PYZdq{}\PYZdq{}\PYZdq{}}
          \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{} Your Code Here \PYZdq{}\PYZdq{}\PYZdq{}}           \PY{c+c1}{\PYZsh{} image height/width}
          \PY{n}{N} \PY{o}{=} \PY{l+m+mi}{80}\PY{o}{*}\PY{l+m+mi}{60}          \PY{c+c1}{\PYZsh{} flat image}
          \PY{n}{m} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{N}\PY{o}{*}\PY{l+m+mf}{0.5}\PY{p}{)}      \PY{c+c1}{\PYZsh{} number of measurements }
          
          \PY{n}{x} \PY{o}{=} \PY{n}{imm}\PY{o}{.}\PY{n}{flatten}\PY{p}{(}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} x = x/np.max(x)}
          \PY{n}{A} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{randint}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{p}{(}\PY{n}{m}\PY{p}{,}\PY{n}{N}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Create measurement matrix, A}
          \PY{n}{A}\PY{p}{[}\PY{n}{A}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
          
          \PY{n}{y} \PY{o}{=} \PY{n}{A}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{x}\PY{p}{)}  \PY{c+c1}{\PYZsh{} y=Ax}
          \PY{n}{x\PYZus{}adj} \PY{o}{=} \PY{n}{A}\PY{o}{.}\PY{n}{T}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{y}\PY{p}{)}
          
          \PY{n}{AtA} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{matmul}\PY{p}{(}\PY{n}{A}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{A}\PY{p}{)}
          \PY{n}{e} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{eig}\PY{p}{(}\PY{n}{AtA}\PY{p}{)}
          \PY{n}{L}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{e}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}228}]:} \PY{n}{im\PYZus{}fista} \PY{o}{=} \PY{n}{fista}\PY{p}{(}\PY{n}{A}\PY{o}{=}\PY{n}{A}\PY{p}{,}\PY{n}{L}\PY{o}{=}\PY{n}{L}\PY{p}{,}\PY{n}{lamda}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{y}\PY{p}{,}\PY{n}{x}\PY{o}{=}\PY{n}{x}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}235}]:} \PY{n}{im\PYZus{}ista} \PY{o}{=} \PY{n}{ista}\PY{p}{(}\PY{n}{A}\PY{o}{=}\PY{n}{A}\PY{p}{,}\PY{n}{L}\PY{o}{=}\PY{n}{L}\PY{p}{,}\PY{n}{lamda}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{,}\PY{n}{y}\PY{o}{=}\PY{n}{y}\PY{p}{,}\PY{n}{x}\PY{o}{=}\PY{n}{x}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}208}]:} \PY{n}{x}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}208}]:} (4800,)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}239}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{80}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Groud Truth}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,}\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{im\PYZus{}fista}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{80}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Fista Recon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{im\PYZus{}ista}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{80}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ista}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,}\PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{x\PYZus{}adj}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{80}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ADJ}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{)}\PY{p}{;} 
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_28_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \textbf{Bonus Problem}: Here, we try to use different methods on image
reconstruction, the results turns to be reasonable. Fista shows the best
performance in the comparason.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}259}]:} \PY{k}{def} \PY{n+nf}{wavMask}\PY{p}{(}\PY{n}{dims}\PY{p}{,} \PY{n}{scale}\PY{p}{)}\PY{p}{:}
              \PY{n}{sx}\PY{p}{,} \PY{n}{sy} \PY{o}{=} \PY{n}{dims}
              \PY{n}{res} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{dims}\PY{p}{)}
              \PY{n}{NM} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log2}\PY{p}{(}\PY{n}{dims}\PY{p}{)}\PY{p}{)}
              \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{NM}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{scale}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{/}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
                  \PY{n}{res}\PY{p}{[}\PY{p}{:}\PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{NM}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{n}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{p}{:}\PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{NM}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{n}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{]} \PY{o}{=} \PYZbs{}
                      \PY{n}{res}\PY{p}{[}\PY{p}{:}\PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{NM}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{n}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{p}{:}\PY{n+nb}{int}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{*}\PY{p}{(}\PY{n}{NM}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{n}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{2}
              \PY{k}{return} \PY{n}{res}
          
          
          \PY{k}{def} \PY{n+nf}{imshowWAV}\PY{p}{(}\PY{n}{Wim}\PY{p}{,} \PY{n}{scale}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
              \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{Wim}\PY{p}{)}\PY{o}{*}\PY{n}{wavMask}\PY{p}{(}\PY{n}{Wim}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{scale}\PY{p}{)}\PY{p}{,} \PY{n}{cmap} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{get\PYZus{}cmap}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
          
              
          \PY{k}{def} \PY{n+nf}{coeffs2img}\PY{p}{(}\PY{n}{LL}\PY{p}{,} \PY{n}{coeffs}\PY{p}{)}\PY{p}{:}
              \PY{n}{LH}\PY{p}{,} \PY{n}{HL}\PY{p}{,} \PY{n}{HH} \PY{o}{=} \PY{n}{coeffs}
              \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{vstack}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{LL}\PY{p}{,} \PY{n}{LH}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{(}\PY{n}{HL}\PY{p}{,} \PY{n}{HH}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          
          
          \PY{k}{def} \PY{n+nf}{unstack\PYZus{}coeffs}\PY{p}{(}\PY{n}{Wim}\PY{p}{)}\PY{p}{:}
                  \PY{n}{L1}\PY{p}{,} \PY{n}{L2}  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{hsplit}\PY{p}{(}\PY{n}{Wim}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)} 
                  \PY{n}{LL}\PY{p}{,} \PY{n}{HL} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{vsplit}\PY{p}{(}\PY{n}{L1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
                  \PY{n}{LH}\PY{p}{,} \PY{n}{HH} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{vsplit}\PY{p}{(}\PY{n}{L2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
                  \PY{k}{return} \PY{n}{LL}\PY{p}{,} \PY{p}{[}\PY{n}{LH}\PY{p}{,} \PY{n}{HL}\PY{p}{,} \PY{n}{HH}\PY{p}{]}
          
              
          \PY{k}{def} \PY{n+nf}{img2coeffs}\PY{p}{(}\PY{n}{Wim}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{:}
              \PY{n}{LL}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{unstack\PYZus{}coeffs}\PY{p}{(}\PY{n}{Wim}\PY{p}{)}
              \PY{n}{coeffs} \PY{o}{=} \PY{p}{[}\PY{n}{c}\PY{p}{]}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{levels}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                  \PY{n}{LL}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{unstack\PYZus{}coeffs}\PY{p}{(}\PY{n}{LL}\PY{p}{)}
                  \PY{n}{coeffs}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{c}\PY{p}{)}
              \PY{n}{coeffs}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{LL}\PY{p}{)}
              \PY{k}{return} \PY{n}{coeffs}
              
              
          \PY{k}{def} \PY{n+nf}{dwt2}\PY{p}{(}\PY{n}{im}\PY{p}{)}\PY{p}{:}
              \PY{n}{coeffs} \PY{o}{=} \PY{n}{pywt}\PY{o}{.}\PY{n}{wavedec2}\PY{p}{(}\PY{n}{im}\PY{p}{,} \PY{n}{wavelet}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{db4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{per}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{level}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
              \PY{n}{Wim}\PY{p}{,} \PY{n}{rest} \PY{o}{=} \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{coeffs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}
              \PY{k}{for} \PY{n}{levels} \PY{o+ow}{in} \PY{n}{rest}\PY{p}{:}
                  \PY{n}{Wim} \PY{o}{=} \PY{n}{coeffs2img}\PY{p}{(}\PY{n}{Wim}\PY{p}{,} \PY{n}{levels}\PY{p}{)}
              \PY{k}{return} \PY{n}{Wim}
          
          
          \PY{k}{def} \PY{n+nf}{idwt2}\PY{p}{(}\PY{n}{Wim}\PY{p}{)}\PY{p}{:}
              \PY{n}{coeffs} \PY{o}{=} \PY{n}{img2coeffs}\PY{p}{(}\PY{n}{Wim}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
              \PY{k}{return} \PY{n}{pywt}\PY{o}{.}\PY{n}{waverec2}\PY{p}{(}\PY{n}{coeffs}\PY{p}{,} \PY{n}{wavelet}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{db4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{per}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \subsection{Part 3 - ADMM for MRI}\label{part-3---admm-for-mri}

In this section, you'll implement ADMM for MRI based on chapter 11.

\textbf{(a)} Implement ADMM for MRI with wavelet and gradient sparsity
(equation 11.4.10).

\textbf{while} \(\boldsymbol x_k\) not converged (k=1,2, ...)
\textbf{do}
\textgreater{}\(\boldsymbol x^{(k+1)} \leftarrow \arg \min_x g_1(\boldsymbol z^{(k)}, \boldsymbol x, \boldsymbol \lambda_1^{(k)})\)
\(\boldsymbol v^{(k+1)} \leftarrow \arg \min_{v_i} g_2(\boldsymbol z^{(k)}, \boldsymbol v_i, \boldsymbol \lambda_2^{(k)})\)
\(\boldsymbol z^{(k+1)} \leftarrow \arg \min_{z} L(\boldsymbol z, \boldsymbol x^{(k+1)}, \boldsymbol v^{(k+1)}, \boldsymbol \lambda_1^{(k)}, \lambda_2^{(k)})\)
\(\boldsymbol \lambda_1^{(k+1)} \leftarrow \boldsymbol \lambda_1^{(k)} + \mu_1(\boldsymbol x^{(k+1)}- \Phi \boldsymbol z^{(k+1)})\)
\(\boldsymbol \lambda_2^{(k+1)} \leftarrow \boldsymbol \lambda_2^{(k)} + \mu_2(\boldsymbol v^{(k+1)}- \boldsymbol \nabla \boldsymbol z^{(k+1)})\)

\textbf{end while} \textbf{Output:
\(\boldsymbol x_* \leftarrow \boldsymbol x_k\)}

While this looks complicated, all the subproblems have relatively
straight forward solutions:

\textbf{while} \(\boldsymbol x_k\) not converged (k=1,2, ...)
\textbf{do}
\textgreater{}\(\boldsymbol x^{(k+1)} \leftarrow S(\Phi \boldsymbol z^{(k)} - \frac{ \boldsymbol \lambda_1^{(k)}}{\mu _1}, \frac{\alpha}{\mu_1})\)
\(\boldsymbol v^{(k+1)}_i \leftarrow S_2((\nabla \boldsymbol z^{(k)})_i - \frac{(\boldsymbol \lambda_2^{(k)})_i}{\mu_2}, \frac{\beta}{\mu_2})\)
\(\boldsymbol z^{(k+1)} \leftarrow M^{-1}\boldsymbol b\)
\(\boldsymbol \lambda_1^{(k+1)} \leftarrow \boldsymbol \lambda_1^{(k)} + \mu_1(\boldsymbol x^{(k+1)}- \phi \boldsymbol z^{(k+1)})\)
\(\boldsymbol \lambda_2^{(k+1)} \leftarrow \boldsymbol \lambda_2^{(k)} + \mu_2(\boldsymbol v^{(k+1)}- \boldsymbol \nabla \boldsymbol z^{(k+1)})\)

\textbf{end while} \textbf{Output:
\(\boldsymbol x_* \leftarrow \boldsymbol x_k\)}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}246}]:} \PY{n}{a} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{+}\PY{l+m+mi}{1}\PY{n}{j}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}251}]:} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{a}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{l+m+mi}{1}\PY{n}{j}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{a}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}251}]:} (1.0000000000000002+1j)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}252}]:} \PY{k}{def} \PY{n+nf}{soft\PYZus{}thresh\PYZus{}complex}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{l}\PY{p}{)}\PY{p}{:}
              \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{sign}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{maximum}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{l}\PY{p}{,} \PY{l+m+mf}{0.}\PY{p}{)}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{exp}\PY{p}{(}\PY{l+m+mi}{1}\PY{n}{j}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}257}]:} \PY{n}{a} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{3}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{]}\PY{p}{)}
          \PY{n}{b} \PY{o}{=} \PY{n}{soft\PYZus{}thresh\PYZus{}complex}\PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{b}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[[ 0.+0.00000000e+00j  1.+0.00000000e+00j  2.+0.00000000e+00j]
 [-2.+2.44929360e-16j -4.+4.89858720e-16j -9.+1.10218212e-15j]
 [ 1.+0.00000000e+00j  2.+0.00000000e+00j -9.+1.10218212e-15j]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}312}]:} \PY{n}{B} \PY{o}{=} \PY{n}{dwt2}\PY{p}{(}\PY{n}{A}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}322}]:} \PY{n}{F} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{dft}\PY{p}{(}\PY{l+m+mi}{100}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}280}]:} \PY{k}{def} \PY{n+nf}{tv}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{:}
              \PY{n}{A} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{roll}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{eye}\PY{p}{(}\PY{n}{n}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
              \PY{n}{A}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
              \PY{n}{A}\PY{p}{[}\PY{n}{n}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{1}
              \PY{n}{A} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{eye}\PY{p}{(}\PY{n}{n}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{A}
              \PY{k}{return} \PY{n}{A}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}387}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{tv}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[[ 1. -1.  0.  0.]
 [ 0.  1. -1.  0.]
 [ 0.  0.  1. -1.]
 [-1.  0.  0.  1.]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}478}]:} \PY{k}{def} \PY{n+nf}{Mfun}\PY{p}{(}\PY{n}{Mask}\PY{p}{,}\PY{n}{V}\PY{p}{,}\PY{n}{z}\PY{p}{,}\PY{n}{u1}\PY{p}{,}\PY{n}{u2}\PY{p}{)}\PY{p}{:}
              \PY{c+c1}{\PYZsh{} M*z}
              \PY{n}{M} \PY{o}{=} \PY{n}{ifft2c}\PY{p}{(}\PY{n}{Mask}\PY{o}{*}\PY{n}{fft2c}\PY{p}{(}\PY{n}{z}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{n}{u2}\PY{o}{*}\PY{n}{V}\PY{o}{.}\PY{n}{T}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{V}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{z}\PY{p}{)}\PY{p}{)} \PY{o}{+} \PY{n}{u1}\PY{o}{*}\PY{n}{z}
              \PY{k}{return} \PY{n}{M}
          
          \PY{k}{def} \PY{n+nf}{gd\PYZus{}update}\PY{p}{(}\PY{n}{Mask}\PY{p}{,}\PY{n}{V}\PY{p}{,}\PY{n}{b}\PY{p}{,}\PY{n}{Iter}\PY{p}{,}\PY{n}{u1}\PY{p}{,}\PY{n}{u2}\PY{p}{)}\PY{p}{:}
              \PY{n}{x} \PY{o}{=} \PY{n}{b}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{Iter}\PY{p}{)}\PY{p}{:}
                  \PY{n}{tmp} \PY{o}{=} \PY{n}{Mfun}\PY{p}{(}\PY{n}{Mask}\PY{p}{,}\PY{n}{V}\PY{p}{,}\PY{n}{x}\PY{p}{,}\PY{n}{u1}\PY{p}{,}\PY{n}{u2}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{b}
                  \PY{n}{grad} \PY{o}{=} \PY{n}{Mfun}\PY{p}{(}\PY{n}{Mask}\PY{p}{,}\PY{n}{V}\PY{p}{,}\PY{n}{tmp}\PY{p}{,}\PY{n}{u1}\PY{p}{,}\PY{n}{u2}\PY{p}{)}
                  \PY{n}{x} \PY{o}{=} \PY{n}{x}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{1}\PY{o}{*}\PY{n}{grad}
                  \PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{tmp}\PY{p}{)}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{norm}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}
              \PY{k}{return} \PY{n}{x}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}481}]:} \PY{k}{def} \PY{n+nf}{admm}\PY{p}{(}\PY{n}{y}\PY{p}{,}\PY{n}{Mask}\PY{p}{,}\PY{n}{u1}\PY{p}{,}\PY{n}{u2}\PY{p}{,}\PY{n}{alpha}\PY{p}{,}\PY{n}{beta}\PY{p}{)}\PY{p}{:}
              \PY{n}{F} \PY{o}{=} \PY{n}{scipy}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{dft}\PY{p}{(}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
              \PY{n}{FT} \PY{o}{=} \PY{n}{F}\PY{o}{.}\PY{n}{T}
              \PY{n}{zk} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{complex64}\PY{p}{)}
              \PY{n}{xk} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{complex64}\PY{p}{)}
              \PY{n}{l1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{complex64}\PY{p}{)}
              \PY{n}{l2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{complex64}\PY{p}{)}
              \PY{n}{V} \PY{o}{=} \PY{n}{tv}\PY{p}{(}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
              \PY{n}{I} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{eye}\PY{p}{(}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
              \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                  \PY{n+nb}{print}\PY{p}{(}\PY{n}{i}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}         print(l1)}
                  \PY{n}{xk1} \PY{o}{=} \PY{n}{soft\PYZus{}thresh\PYZus{}complex}\PY{p}{(}\PY{n}{dwt2}\PY{p}{(}\PY{n}{zk}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{l1}\PY{o}{/}\PY{n}{u1}\PY{p}{,}\PY{n}{alpha}\PY{o}{/}\PY{n}{u1}\PY{p}{)}
                  \PY{n}{vk1} \PY{o}{=} \PY{n}{soft\PYZus{}thresh\PYZus{}complex}\PY{p}{(}\PY{n}{V}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{zk}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{l2}\PY{o}{/}\PY{n}{u2}\PY{p}{,}\PY{n}{beta}\PY{o}{/}\PY{n}{u2}\PY{p}{)}
                  \PY{n}{yy} \PY{o}{=} \PY{n}{ifft2c}\PY{p}{(}\PY{n}{Mask}\PY{o}{*}\PY{n}{y}\PY{p}{)}\PY{o}{+}\PY{n}{idwt2}\PY{p}{(}\PY{n}{l1}\PY{o}{+}\PY{n}{u1}\PY{o}{*}\PY{n}{xk1}\PY{p}{)}\PY{o}{+}\PY{n}{V}\PY{o}{.}\PY{n}{T}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{u2}\PY{o}{*}\PY{n}{vk1}\PY{o}{+}\PY{n}{l2}\PY{p}{)}
                  \PY{c+c1}{\PYZsh{} M = I + u1*I + u2*V.T.dot(V) }
                  \PY{n}{zk1} \PY{o}{=} \PY{n}{gd\PYZus{}update}\PY{p}{(}\PY{n}{Mask}\PY{p}{,}\PY{n}{V}\PY{p}{,}\PY{n}{yy}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{u1}\PY{p}{,}\PY{n}{u2}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}         zk1 = np.dot(np.linalg.inv(M),yy)}
                  \PY{n}{l1k} \PY{o}{=} \PY{n}{l1} \PY{o}{+} \PY{n}{u1}\PY{o}{*}\PY{p}{(}\PY{n}{xk1}\PY{o}{\PYZhy{}}\PY{n}{dwt2}\PY{p}{(}\PY{n}{zk1}\PY{p}{)}\PY{p}{)}
                  \PY{n}{l2k} \PY{o}{=} \PY{n}{l2} \PY{o}{+} \PY{n}{u2}\PY{o}{*}\PY{p}{(}\PY{n}{vk1} \PY{o}{\PYZhy{}} \PY{n}{V}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{zk1}\PY{p}{)}\PY{p}{)}
                  \PY{n}{zk} \PY{o}{=} \PY{n}{zk1}
                  \PY{n}{l1} \PY{o}{=} \PY{n}{l1k}
                  \PY{n}{l2} \PY{o}{=} \PY{n}{l2k}
                  \PY{n}{vk} \PY{o}{=} \PY{n}{vk1}
                  \PY{n}{xk} \PY{o}{=} \PY{n}{xk1}
              \PY{k}{return} \PY{n}{zk}
                  
              \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}Your code here\PYZdq{}\PYZdq{}\PYZdq{}}
\end{Verbatim}


    \textbf{(b)} Use your code to reconstruct the brain images using the
subsampled fourier measurments defined below (M1 and M2). (For more info
on MRI, see Discussion 2 materials).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}242}]:} \PY{n}{data} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brain.npz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{im}\PY{p}{,} \PY{n}{mask\PYZus{}unif}\PY{p}{,} \PY{n}{mask\PYZus{}vardens}\PY{p}{,} \PY{n}{pdf\PYZus{}unif}\PY{p}{,} \PY{n}{pdf\PYZus{}vardens} \PY{o}{=} \PYZbs{}
          \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{im}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mask\PYZus{}unif}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mask\PYZus{}vardens}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pdf\PYZus{}unif}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pdf\PYZus{}vardens}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{im}\PY{p}{)}\PY{p}{,} \PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;} \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{mask\PYZus{}unif}\PY{p}{)}\PY{p}{;} \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{uniform sampling mask}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{mask\PYZus{}vardens}\PY{p}{)}\PY{p}{;} \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{variable density sampling mask}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_43_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}326}]:} \PY{k}{def} \PY{n+nf}{fft2c}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
              \PY{k}{return} \PY{l+m+mi}{1} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{prod}\PY{p}{(}\PY{n}{x}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fft2}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{ifftshift}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          
          \PY{k}{def} \PY{n+nf}{ifft2c}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{:}
              \PY{k}{return} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{prod}\PY{p}{(}\PY{n}{y}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{)} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{ifftshift}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{ifft2}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{fft}\PY{o}{.}\PY{n}{fftshift}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{M} \PY{o}{=} \PY{n}{fft2c}\PY{p}{(}\PY{n}{im}\PY{p}{)}\PY{p}{;}
          \PY{n}{M1} \PY{o}{=} \PY{p}{(}\PY{n}{M} \PY{o}{*} \PY{n}{mask\PYZus{}unif}\PY{p}{)}\PY{o}{/} \PY{n}{pdf\PYZus{}unif}\PY{p}{;}
          \PY{n}{M2} \PY{o}{=} \PY{p}{(}\PY{n}{M} \PY{o}{*} \PY{n}{mask\PYZus{}vardens}\PY{p}{)}\PY{o}{/} \PY{n}{pdf\PYZus{}vardens}\PY{p}{;}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{M}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;} \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fully sampled fourier space}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{M1}\PY{o}{*}\PY{p}{(}\PY{n}{M1}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{;} \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M1, uniform subsampled fourer space}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{M2}\PY{o}{*}\PY{p}{(}\PY{n}{M2}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{;} \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M2, variable density subsampled fourer space}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/home/kewang/anaconda3/lib/python3.6/site-packages/ipykernel\_launcher.py:15: RuntimeWarning: divide by zero encountered in log
  from ipykernel import kernelapp as app
/home/kewang/anaconda3/lib/python3.6/site-packages/ipykernel\_launcher.py:17: RuntimeWarning: divide by zero encountered in log

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_44_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}485}]:} \PY{n}{im\PYZus{}admm} \PY{o}{=} \PY{n}{admm}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{n}{M2}\PY{p}{,}\PY{n}{Mask} \PY{o}{=} \PY{n}{mask\PYZus{}vardens}\PY{p}{,}\PY{n}{u1}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{u2} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.05}\PY{p}{,}\PY{n}{beta}\PY{o}{=}\PY{l+m+mf}{0.05}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} F = scipy.linalg.dft(512)}
          \PY{c+c1}{\PYZsh{} im\PYZus{}fft = np.dot(F,M)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
0
0.13855984328665547
0.11780445747673887
0.10053350732278223
0.08610540113925225
0.07399878839562514
0.06379263834823058
0.05514812294937781
0.04779287180576076
0.041507720570704516
0.03611582145877221
0.03147385616931522
0.027465042007965703
0.02399362052980327
0.020980543348327375
0.01836010757137127
0.01607733454286531
0.014085924888813503
0.012346657620764463
0.010826130272888552
0.009495760771670183
0.008330990508037239
0.007310642655064583
0.006416400931320593
0.005632382465229629
0.0049447847791393865
0.004341591680168292
0.003812326411101471
0.003347843082029056
0.0029401494026331768
0.0025822552390972553
0.0022680426572619667
0.0019921539800509384
0.0017498950523513483
0.001537151421876381
0.001350315547763914
0.0011862234674499352
0.001042099607055041
0.0009155086261478028
0.0008043133554434362
0.0007066380240535717
1
0.12002388798788328
0.10394130398844971
0.09024586877884552
0.07853658565859269
0.0684880360168952
0.059835796328918285
0.052364298987447405
0.045896962485476166
0.0402882992444282
0.03541767525137146
0.03118440828035714
0.02750392696178035
0.02430475657387173
0.021526140805903177
0.019116147804896656
0.017030142195042973
0.015229532681311992
0.013680728366960392
0.012354257283214822
0.011224018711972088
0.010266656567407247
0.009461052948799144
0.008787946539121749
0.00822967771003514
0.007770051288936063
0.007394292903248687
0.007089062257990265
0.006842482582841862
0.0066441517018004815
0.006485113745699717
0.006357785822923321
0.006255846028831417
0.006174095717581192
0.006108310326237686
0.006055090994879931
0.006011725699218841
0.005976065008182646
0.005946414633047956
0.00592144486761425
0.005900115759453512
2
0.1118588768721406
0.09799931913606773
0.08598182945760241
0.0755392678599558
0.06645027224520886
0.05853035839765752
0.05162480535955618
0.04560301936968089
0.04035408323505954
0.035783233655521746
0.03180905174847004
0.028361194101637104
0.02537852995991669
0.02280758415694559
0.020601215896349986
0.018717491210265915
0.01711873143839487
0.015770739014558426
0.014642211236871339
0.013704348906488738
0.012930649666138291
0.012296851313470993
0.011780968716576896
0.011363359222616023
0.01102675954757226
0.01075625801257541
0.0105391907849203
0.010364971133485036
0.01022487234667309
0.010111788004495944
0.01001999042484743
0.009944902480434888
0.00988289201025072
0.009831093047926715
0.009787254505070888
0.00974961471037022
0.009716799025625016
0.009687737312018926
0.009661598026095624
0.009637735980263233
3
0.1078185759537651
0.09516367915543572
0.08406016346641018
0.07431712557629729
0.0657709944615479
0.05828079762148447
0.05172439623110031
0.04599546657871561
0.04100104414753928
0.036659485139441284
0.03289873567066414
0.029654831340218388
0.026870580270371657
0.024494411234198533
0.022479393265342963
0.020782449760821862
0.01936379277322884
0.01818658826703751
0.01721683316708072
0.016423390461701607
0.015778103905860857
0.015255909824031697
0.01483488116693821
0.014496169730623029
0.014223843963186367
0.014004642641926567
0.013827675518850032
0.013684102536223283
0.013566817456865646
0.013470153677920161
0.01338962226835723
0.013321686173109406
0.013263570353437813
0.01321310514830879
0.01316859892185596
0.01312873568692847
0.013092493525844148
0.013059080025851363
0.013027881452033612
0.012998422901245643
4
0.10594337168453065
0.09394248344605505
0.0833461047417605
0.0740038086545603
0.06578233713351621
0.05856330822441906
0.052241311060535145
0.04672227202630868
0.04192200668256678
0.037764900595254565
0.03418268954497526
0.03111333652417982
0.02850002812686823
0.02629033193299949
0.02443556232586831
0.02289038865198554
0.02161268638005595
0.0205635879987941
0.01970765228636953
0.01901305407657962
0.01845170783364094
0.017999270624255805
0.01763500914253623
0.01734154776020565
0.017104533098445368
0.016912255365099233
0.016755261875495663
0.016625988841405388
0.01651842756800983
0.016427832815017935
0.01635047501189469
0.016283434175558317
0.016224431300369626
0.016171692143951248
0.016123838260622143
0.016079800496004805
0.016038750721774825
0.016000048216209296
0.01596319770360902
0.015927816613655915
5
0.10516922923939054
0.09353092095923587
0.0832261814395529
0.07412517468715363
0.06610998304758914
0.05907356551549134
0.05291877090816409
0.04755736247158202
0.04290903394773965
0.03890042057434805
0.03546413267208725
0.03253786228927958
0.03006362899023098
0.027987230968691153
0.026257945626244027
0.02482848054320793
0.02365512330239203
0.022697996281560554
0.02192130721510367
0.021293502763223324
0.020787271050800332
0.020379383251722425
0.0200503990641336
0.019784279508910502
0.019567953818504666
0.019390880414890746
0.019244630804074056
0.019122513830108545
0.019019248359862656
0.01893068580272917
0.018853579712676226
0.018785397516135956
0.018724168552534753
0.01866836259466906
0.01861679345876975
0.018568542968744012
0.01852290125209116
0.018479320030272778
0.0184373761815977
0.01839674338423627
6
0.10492507803687255
0.09349781113270113
0.08337090235987074
0.074424884473894
0.06654953112403893
0.05964340902119428
0.05361331176059217
0.048373576222833344
0.04384530351203743
0.03995552894701468
0.03663640796186601
0.033824501029383176
0.03146024181856802
0.029487650600995147
0.027854308682337733
0.026511550551212765
0.02541477918008036
0.02452378645082315
0.023802972847314745
0.023221400120502816
0.02275265946317894
0.0223745784926978
0.02206881383992052
0.021820382179354288
0.021617176325576866
0.0214495009760733
0.021309649788762985
0.021191534554808343
0.021090369265822678
0.021002406783100603
0.020924723014540163
0.02085504231414582
0.020791597649498807
0.02073301949194212
0.020678248072225645
0.020626464423647524
0.020577036398198134
0.020529476534491074
0.020483409257377586
0.02043854539467684
7
0.10492277457423886
0.0936267166492412
0.08361596826313186
0.07477635086953807
0.0670015251064647
0.06019281036008906
0.05425879968839412
0.04911479855610593
0.04468213754325785
0.04088743208987058
0.037661881805548504
0.03494070905762106
0.03266282151070878
0.030770741372321463
0.029210782342211142
0.02793339306149516
0.02689354666703825
0.026051054374011694
0.025370714215343516
0.02482225729204623
0.024380102782317097
0.024022965760559803
0.023733374971356806
0.023497155074608856
0.023302916409763296
0.02314158118058943
0.02300596206290847
0.022890399325126848
0.022790455882065023
0.022702665784513243
0.022624329752607506
0.022553350802282504
0.02248810324888012
0.022427329019388167
0.022370056019102264
0.022315534134035853
0.02226318522903672
0.02221256418782795
0.022163328624763768
0.022115215382362743
8
0.10502042744823807
0.09381134991912247
0.0838811525469984
0.07511841674685905
0.06741879201221476
0.06068492833104061
0.05482616244557741
0.04975800479619376
0.045401497334886354
0.04168253529584591
0.038531261304335526
0.0358816373039646
0.03367126980480917
0.031841507187398914
0.030337758385651278
0.029109924457783418
0.028112810432923054
0.02730640165082218
0.026655935613811528
0.026131755888414335
0.025708979523094016
0.025367034230046583
0.025089126736325865
0.024861695519186853
0.024673886888065162
0.024517078562349713
0.024384462528258898
0.024270690042057126
0.024171575994904427
0.024083856775628763
0.02400499448469818
0.023933020200539137
0.023866409483691408
0.02380398409165071
0.02374483476056986
0.023688260771493268
0.02363372279912846
0.023580806216714822
0.023529192598144448
0.02347863762553906
9
0.10515104926715112
0.09400286338308772
0.08413118945579467
0.07542608587464808
0.06778422838918642
0.06110888393397478
0.05530961952929234
0.05030180627222997
0.04600600334252905
0.04234732915911171
0.039254937214645645
0.03666170143970123
0.0345041734704536
0.03272280724529419
0.0312623745873029
0.03007244520456301
0.029107794640104184
0.028328634597860548
0.02770061497272536
0.02719460288901966
0.02678628400990313
0.026455649406384972
0.026186430704339996
0.025965534504269486
0.025782511360639065
0.025629079737981772
0.025498713634458894
0.025386294486368175
0.02528782308624714
0.02520018476935905
0.025120960261703212
0.025048274702035404
0.02498067799594889
0.02491705053413266
0.024856529229915325
0.0247984497045971
0.024742301226122705
0.02468769167158389
0.02463432033826525
0.024581956881410568

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}456}]:} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{fft2c}\PY{p}{(}\PY{n}{ifft2c}\PY{p}{(}\PY{n}{im}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{im}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}456}]:} 4.518280359883027e-16
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}492}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{im}\PY{p}{)}\PY{p}{,} \PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ground Truth}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{im\PYZus{}admm}\PY{p}{)}\PY{p}{,}\PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;} \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ADMM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{ifft2c}\PY{p}{(}\PY{n}{mask\PYZus{}vardens}\PY{o}{*}\PY{n}{M2}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}\PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{IFFT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_47_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
